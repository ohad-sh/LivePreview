// Main LivePreview JS file. Version 24-05-2013
document.addEventListener("DOMContentLoaded",function(){var h=document.getElementById("html"),j=document.getElementById("css"),c=document.getElementById("frame"),m=c.contentDocument.head,i=c.contentDocument.body;function b(t){if(t.match(/\$[A-z]+[\s+]?[=][\s+]?[#]?["]?[A-z0-9\s+\,\-]+["]?/g)){var o=t.match(/[A-z\-]+[:][\s+]?[\-]?[A-z-?(?,?\s+?\$)?0-9?]+/g),v=t.match(/\$[A-z]+[\s+]?[=][\s+]?[#]?[()A-z0-9\s+\,\-\'\"]+/g);var p=[];for(var r=0;r<v.length;r++){var u=v[r].split("=");p[u[0].replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/[;]/g,"")]=u[1].replace(/^\s+/g,"").replace(/\s+$/g,"");t=t.replace(v[r],"");}for(var r=0;r<o.length;r++){if(o[r].match(/\$[A-z]+/g)){var w=o[r].match(/\$[A-z]+/g);for(var s=0;s<w.length;s++){if(p[w[s]]){t=t.replace(w[s],p[w[s]]);}}}}var q=t.match(/[;\s+]+/g)[0];return t.replace(q,"");}else{return t;}}if(window.localStorage){var f='<div id="frame-message">This is the pallet, the world to <strong>your</strong> code.</div>\n\n\n<p>You may now clear all fields and begin writing your own HTML and CSS code.<br>\n\n<em>LivePreview &mdash; A front end playground.</em></p>',e='$lg = lightgray;\n$ws = whitesmoke;\n\n#frame-message {\nbackground: $ws;\nborder: 1px solid $lg;\npadding: 10px;\nfont-family: arial;\nfont-weight: lighter;\ntext-align: center;\nfont-style: italic;\nfont-size: 2em;\n}\n\n#frame-message:before {\n content: "\\201c"; \n font-size: 30px;\n}\n\n#frame-message:after {\n content: "\\201d"; \n font-size: 30px;\n}\n\np {\n font-family: sans-serif; \n text-align: center;\n}';if(!localStorage.getItem("html_val")){localStorage.setItem("html_val",f);}if(!localStorage.getItem("css_val")||localStorage.getItem("css_val")==="undefined"||localStorage.getItem("css_val").length===1){localStorage.setItem("css_val",e);}}var l=CodeMirror.fromTextArea(h,{mode:"htmlmixed",value:this.value,lineWrapping:true});var k=CodeMirror.fromTextArea(j,{mode:"text/x-scss",value:this.value,lineWrapping:true});var n=document.querySelectorAll(".CodeMirror")[0],g=document.querySelectorAll(".CodeMirror")[1];n.setAttribute("id","html");g.setAttribute("id","css");var a=document.createElement("style"),d=document.createElement("div");d.setAttribute("name","HTML-Content");n.onkeyup=function(){if(window.localStorage){localStorage.setItem("html_val",l.getValue());d.innerHTML=localStorage.getItem("html_val");}else{d.innerHTML=l.getValue();}};g.onkeyup=function(){if(window.localStorage){localStorage.setItem("css_val",k.getValue());a.innerText=b(localStorage.getItem("css_val").replace(/\n/g,""));}else{a.innerText=b(k.getValue().replace(/\n/g,""));}};if(window.localStorage){if(localStorage.getItem("html_val")){l.setValue(localStorage.getItem("html_val"));d.innerHTML=localStorage.getItem("html_val");}if(localStorage.getItem("css_val")){k.setValue(localStorage.getItem("css_val"));if(localStorage.getItem("css_val").match(/\$[A-z]+[\s+]?[=][\s+]?[#]?["]?[A-z0-9\s+\,\-]+["]?/g)){a.innerText=b(localStorage.getItem("css_val").replace(/\n/g,""));}else{a.innerText=localStorage.getItem("css_val").replace(/\n/g,"");}}}else{d.innerHTML=l.getValue();a.innerText=k.getValue().replace(/\n/g,"");}i.appendChild(d);m.appendChild(a);},false);