// Main LivePreview JS file. Version 28-05-2013
document.addEventListener("DOMContentLoaded",function(){var h=document.getElementById("html"),j=document.getElementById("css"),c=document.getElementById("frame"),m=c.contentDocument.head,i=c.contentDocument.body;c.style.height=window.innerHeight+"px";document.getElementById("boxes").style.height=window.innerHeight+"px";document.getElementById("boxes").style.top="0px";function b(u){if(u.match(/\$[A-z]+[\s+]?[=][\s+]?[#]?[()A-z0-9\s+\,\-\'\"\.]+/g)){var t=u.match(/[A-z\-]+[:][\s+]?[\-]?[A-z-?%?(?,?\s+?\$)?0-9?]+/g),v=u.match(/\$[A-z]+[\s+]?[=][\s+]?[#]?[()A-z0-9\s+\,\-\'\"\.]+[;]/g);var r=[];for(var q=0;q<v.length;q++){var p=v[q].split("=");r[p[0].replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/[;]/g,"")]=p[1].replace(";","").replace(/^\s+/g,"").replace(/\s+$/g,"");u=u.replace(v[q],"");}for(var q=0;q<t.length;q++){if(t[q].match(/\$[A-z]+/g)){var o=t[q].match(/\$[A-z]+/g);for(var s=0;s<o.length;s++){if(r[o[s]]){u=u.replace(o[s],r[o[s]]);}}}}return u.replace(/^\s+/,"").replace(/\s+$/,"");}else{return u;}}if(window.localStorage){var f='<div id="frame-message">This is the pallet, the world to <strong>your</strong> code.</div>\n\n\n<p>You may now clear all fields and begin writing your own HTML and CSS code.<br>\n\n<em>LivePreview &mdash; A front end playground.</em></p>',e='$lg = lightgray;\n$ws = whitesmoke;\n\n#frame-message {\nbackground: $ws;\nborder: 1px solid $lg;\npadding: 10px;\nfont-family: arial;\nfont-weight: lighter;\ntext-align: center;\nfont-style: italic;\nfont-size: 2em;\n}\n\n#frame-message:before {\n content: "\\201c"; \n font-size: 30px;\n}\n\n#frame-message:after {\n content: "\\201d"; \n font-size: 30px;\n}\n\np {\n font-family: sans-serif; \n text-align: center;\n}';if(!localStorage.getItem("html_val")){localStorage.setItem("html_val",f);}if(!localStorage.getItem("css_val")||localStorage.getItem("css_val")==="undefined"||localStorage.getItem("css_val").length===1){localStorage.setItem("css_val",e);}}var l=CodeMirror.fromTextArea(h,{mode:"htmlmixed",value:this.value,lineWrapping:true});var k=CodeMirror.fromTextArea(j,{mode:"text/x-scss",value:this.value,lineWrapping:true});var n=document.querySelectorAll(".CodeMirror")[0],g=document.querySelectorAll(".CodeMirror")[1];n.setAttribute("name","html");g.setAttribute("name","css");var a=document.createElement("style"),d=document.createElement("div");d.setAttribute("name","HTML-Content");n.onkeyup=function(){if(window.localStorage){localStorage.setItem("html_val",l.getValue());d.innerHTML=localStorage.getItem("html_val");}else{d.innerHTML=l.getValue();}};g.onkeyup=function(){if(window.localStorage){localStorage.setItem("css_val",k.getValue());a.textContent=b(localStorage.getItem("css_val"));}else{a.textContent=b(k.getValue());}};if(window.localStorage){if(localStorage.getItem("html_val")){l.setValue(localStorage.getItem("html_val"));d.innerHTML=localStorage.getItem("html_val");}if(localStorage.getItem("css_val")){k.setValue(localStorage.getItem("css_val"));if(localStorage.getItem("css_val").match(/\$[A-z]+[\s+]?[=][\s+]?[#]?["]?[A-z0-9\s+\,\-]+["]?/g)){a.textContent=b(localStorage.getItem("css_val"));}else{a.textContent=localStorage.getItem("css_val");}}}else{d.innerHTML=l.getValue();a.textContent=k.getValue();}i.appendChild(d);m.appendChild(a);},false);